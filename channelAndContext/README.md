# 채널과 컨텍스트
채널, 컨텍스트, 고루틴 => 동시성 프로그래밍

### 채널
채널은 고루틴 간 메시지를 전달할 수 있는 `메시지 큐`  

채널을 사용하면 locking을 안해도 된다. 

chan은 채널 키워드, string은 메시지의 타입을 의미한다. 
```
var messages chan string = make(chan string)
```

채널에 데이터 넣기(채널 인스턴스가 `좌측`) 
```
messages<-"this is a data"
```

채널에서 데이터 빼기(채널 인스턴스가 `우측`) 
```
var msg string=<-messages
```

### 채널 동작 
- 채널의 기본 크기는 0
- 채널의 크기가 0인 경우(빈 자리가 없는 경우), 채널에 넣으려면 `수신자가 대기하고 있어야` 한다. 
- 채널에 빈자리가 있는 경우, `수신자가 대기하고 있건 말건` 채널에 넣는다. 
보관함이 있을 때 보관함에 보관하고 다음일을 한다. 


### 좀비 고루틴
채널을 닫아주지 않아서 무한 대기를 하는 고루틴을 좀비 고루틴 또는 고루틴 릭이라고 한다. 
실무에서는 고루틴을 많이 사용한다. 
`채널을 습관적으로 닫아주는 연습`을 해야 한다.


### select문
- switch 문과 비슷하지만, 전혀 다름
- 여러 채널에서 동시에 데이터를 기다릴 때 사용
```
select {
    case n:= <- ch1: // ch1 채널에서 데이터를 가져올 수 있을 때 실행 
        ...
    case n2:= <- ch2: // ch2 채널에서 데이터를 가져올 수 있을 때 실행 
        ...
}

```

### select 예제 
- time 패키지의 Tick()은 일정 간격으로 신호를 주는 채널을 반환
- time 패키지의 After()는 일정 시간 대기후 한번만 신호를 주는 채널을 반환 

### 생산자/소비자 패턴
차체 생산 => 채널 => 바퀴 설치 => 채널 => 도색 
즉, 역할을 나누는 것이다. 


### 컨텍스트
작업을 지시할 때 작업 가능 시간, 작업 취소 등의 조건을 지시할 수 있는 작업 명세서 역할 
고루틴에다가 명세를 주고 고루틴은 그 명세에 따라 필요한 것을 만들어 준다. 
기본적으로 컨텍스트는 wrapping하는 방식이다.
기본 컨텍스트 생성 후, 기본 컨텍스트에 새로운 기능을 계속 추가하는 방식이다. 


### 채널로 발행/구독 패턴
Publisher/Subscriber 패턴 구현
옵저버 패턴과 거의 유사 
구독자는 토픽을 구독하고, 
발행자는 토픽에 메시지를 발행한다. 